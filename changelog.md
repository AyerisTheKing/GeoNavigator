# –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π (Changelog)

## [v12.2] - 2026-01-30

### üöë Hotfix (API Key Restoration)

- **Config:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ–ø–µ—á–∞—Ç–∫–∞ –≤ `SUPABASE_KEY` (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á).
- **Status:** –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω.

## [v12.1] - 2026-01-30

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch)

- **Script:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–ª–µ—Ç `saveStats is not a function`.
- **Logic:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `saveStats` (–∞–ª–∏–∞—Å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞).

## [v12.0] - 2026-01-30

### ‚ö†Ô∏è DATABASE RESET REQUIRED

**–í–Ω–∏–º–∞–Ω–∏–µ!** –≠—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–≥–æ —Å–±—Ä–æ—Å–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

1. –í—ã–ø–æ–ª–Ω–∏—Ç–µ `TRUNCATE TABLE profiles;`
2. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–ª–æ–Ω–æ–∫ (—Å–º. `migration_v12.sql`).

### üöÄ Major Update (Stats & DB Structure)

- **Database:** –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Å—Ç—Ä–æ–π–∫–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.
  - –ù–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏ JSONB: `stat_easy`, `stat_normal`, `stat_hard`, `stat_extreme`.
  - –ö–æ–ª–æ–Ω–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏: `recent_games` (—Ö—Ä–∞–Ω–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 50 –∏–≥—Ä).
  - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å—á–µ—Ç—á–∏–∫: `total_correct`.
- **Logic:** –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ–ø–∏—Å—å –∞–ª–≥–æ—Ä–∏—Ç–º–∞ `saveGameStats`.
  - –†–µ–∂–∏–º `MostMost` —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `stat_normal`.
  - –û—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç–∏.
  - –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ JSON (Read-Modify-Write).

## [v11.11] - 2026-01-29

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch)

- **UI:** –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –±–∞–≥ "–ú–∞—Ç—Ä—ë—à–∫–∞": –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ –±—ã–ª–æ –≤–ª–æ–∂–µ–Ω–æ –≤ –õ–∏–¥–µ—Ä–±–æ—Ä–¥, –∏–∑-–∑–∞ —á–µ–≥–æ –∫–Ω–æ–ø–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª–∏. –¢–µ–ø–µ—Ä—å –æ–Ω–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã.
- **UI:** –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å—Ç–∏–ª—å (`btn-secondary`) –∏ —Ä–∞–±–æ—á—É—é –ª–æ–≥–∏–∫—É –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –ø—Ä–æ—Ñ–∏–ª—å.

## [v11.16] - 2026-01-29

### üöÄ –ù–æ–≤–æ–µ (Minor: New Game Mode)

- **Mode:** –î–æ–±–∞–≤–ª–µ–Ω —Ä–µ–∂–∏–º "–°–∞–º—ã–π-—Å–∞–º—ã–π" (The Most).
- **Files:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è `the_most.geo.json` —Å —Ç–æ—á–∫–∞–º–∏ —Ä–µ–∫–æ—Ä–¥–æ–≤.
- **Gameplay:** –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ —Ç–æ—á–µ–∫, –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏, —Ñ–∞–∫—Ç—ã.

## [v11.10] - 2026-01-29

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch: Fix Trigger Logic)

- **Database:** –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–∞ `handle_new_user` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ `nickname`.
- **Script:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞ `nickname` –≤ `auth.signUp`.

> **‚ö†Ô∏è SQL Update Required**
>
> –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–π SQL-–∑–∞–ø—Ä–æ—Å –≤ Supabase Dashboard (SQL Editor) –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏–Ω–æ–≤ –≤ –ø–æ–ª–µ nickname:
>
> ```sql
> create or replace function public.handle_new_user()
> returns trigger
> language plpgsql
> security definer set search_path = public
> as $$
> begin
>   insert into public.profiles (id, login, nickname, email, created_at)
>   values (
>     new.id,
>     new.raw_user_meta_data->>'login',
>     COALESCE(new.raw_user_meta_data->>'nickname', new.raw_user_meta_data->>'login'),
>     new.email,
>     now()
>   );
>   return new;
> end;
> $$;
> ```

## [v11.9] - 2026-01-29

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch)

- **Registration Fix**: –ú–µ—Ç–æ–¥ `signUp` —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞–µ—Ç `nickname` –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö.
- **Race Condition**: –£–¥–∞–ª–µ–Ω —Ä—É—á–Ω–æ–π `insert` –ø—Ä–æ—Ñ–∏–ª—è (–ø–µ—Ä–µ–ª–æ–∂–µ–Ω–æ –Ω–∞ DB Trigger).

## [v11.8] - 2026-01-29

### üõ° –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (Minor Update)

- **SQL Constraints**: –í–Ω–µ–¥—Ä–µ–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î (check_nickname_length, check_login_length, check_login_chars).
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –î–æ–±–∞–≤–ª–µ–Ω —Å—Ç—Ä–æ–≥–∏–π Regex-—Ñ–∏–ª—å—Ç—Ä –¥–ª—è –ª–æ–≥–∏–Ω–æ–≤ (5-30, –ª–∞—Ç–∏–Ω–∏—Ü–∞) –∏ –Ω–∏–∫–æ–≤ (3-15, –∫–∏—Ä–∏–ª–ª–∏—Ü–∞/–ª–∞—Ç–∏–Ω–∏—Ü–∞).
- **XSS Protection**: –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞–∑ –æ—Ç `innerHTML` –ø—Ä–∏ –≤—ã–≤–æ–¥–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–Ω–¥–µ—Ä–µ –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–≤ –∏ –ø—Ä–æ—Ñ–∏–ª—è.

## [v11.3] - 2026-01-29

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch)

- **UI:** –£–¥–∞–ª–µ–Ω–∞ –ª–∏—à–Ω—è—è –∏–∫–æ–Ω–∫–∞ üìú –∏–∑ –∫–Ω–æ–ø–∫–∏ "–ò—Å—Ç–æ—Ä–∏—è".
- **–õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω –∫–ª—é—á –ø–µ—Ä–µ–≤–æ–¥–∞ `history` –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏.

## [v11.2] - 2026-01-29

### üßπ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (Patch)

- **–§–∞–π–ª:** `script.js`
  - –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∏–∑–º–µ–Ω–µ–Ω–∏–π.
  - –û—á–∏—Å—Ç–∫–∞ –∫–æ–¥–∞ –æ—Ç –º–µ—Ç–æ–∫ –≤–µ—Ä—Å–∏–π (vX.X).

## [v11.1] - 2026-01-29

### üì¶ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

- **–§–∞–π–ª:** `script.js` (Header)
  - –£–¥–∞–ª–µ–Ω –º–∞—Å—Å–∏–≤–Ω—ã–π –±–ª–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –≤–µ—Ä—Å–∏–π.
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ `CHANGELOG.md`.
- **–§–∞–π–ª:** `CHANGELOG.md`
  - –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª –¥–ª—è –≤–µ–¥–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

## [v11.0] - 2026-01-29

### ‚ú® –ù–æ–≤–æ–µ (Minor)

- **–§–∞–π–ª:** `script.js` -> –º–µ—Ç–æ–¥ `saveStats`
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 10 –º–∞—Ç—á–µ–π (JSONB).
- **–§–∞–π–ª:** `index.html`
  - –î–æ–±–∞–≤–ª–µ–Ω–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ `#historyModal`.
  - –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ "–ò—Å—Ç–æ—Ä–∏—è" –≤ –ø—Ä–æ—Ñ–∏–ª—å.

## [v10.9] - 2026-01-28

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch)

- **UI:** Leaderboard UI Polish. –û–±–Ω–æ–≤–ª–µ–Ω –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤ –∏ –∫–Ω–æ–ø–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.

## [v10.4] - 2026-01-29

### üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ (Patch)

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ "Zombie-account" –≤ `handleAuthSession`.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ NaN –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç –∫–∞—Ä—Ç—ã.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (–ø–µ—Ä–µ–¥–∞—á–∞ login –≤ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ).

## [v10.3] - 2026-01-29

### üì¶ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

- –û—á–∏—Å—Ç–∫–∞ –¥—É–±–ª–∏—Ä—É—é—â–µ–≥–æ—Å—è –∫–æ–¥–∞.
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –∏–≥—Ä—ã.

## [v10.0] - 2026-01-28

### ‚ú® –ù–æ–≤–æ–µ (Major)

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ë–î (JSONB stats).
- –°–∏—Å—Ç–µ–º–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–µ–π (Easy, Normal, Hard, Extreme).
