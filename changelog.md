# История изменений

## v12.7 (Feature: Ban System)

### Data

- **SQL**: Добавлена колонка `is_banned` в таблицу `profiles`.
  ```sql
  ALTER TABLE profiles ADD COLUMN IF NOT EXISTS "is_banned" BOOLEAN DEFAULT FALSE;
  ```

### Logic

- **Auth**: Блокировка входа для забаненных пользователей (Script Check).
- **Leaderboard**: Скрытие забаненных игроков из таблицы лидеров.

## v12.5 (Patch: Map UI & Visibility)

### UI

- **Карта**: Скрыты лишние кнопки управления зумом и копирайты для чистоты интерфейса.
- **Метки**: Теперь на сложностях Easy и Normal карта отображает названия стран и городов (Dark All), а на Hard/Extreme она остается "слепой" (Dark NoLabels).

## v12.4

### UI & Config

- **Смена языка**: Блок выбора языка скрыт в настройках.
- **Локализация**: Русский язык теперь установлен принудительно для всех пользователей по умолчанию.

## v12.3 (Hotfix)

### Исправлено

- Исправлена критическая ошибка с `SUPABASE_KEY` (была опечатка в константе).

## v12.2

### Исправлено

- Исправлена ошибка `this.saveStats is not a function`. Метод `saveStats` теперь корректно вызывается из экземпляра класса.

## v12.0 (Major Update)

### База данных

- Полная миграция структуры БД.
- Добавлены JSONB колонки: `stat_easy`, `stat_normal`, `stat_hard`, `stat_extreme`, `recent_games`.
- Добавлена колонка `total_correct`.
- Удалены старые колонки статистики.

### Рефакторинг

- Полностью переписана система сохранения статистики (`saveGameStats`).
- Реализована логика Read-Modify-Write для обновления JSONB данных.
- Исправлен маппинг режимов игры на поля БД.

## v11.9

### Новое

- **Новый режим**: Добавлен режим "Самый-самый" (The Most).
- **Контент**: Добавлена база вопросов для нового режима (`the_most.geo.json`).
- **Геймплей**: Реализована логика вопросов, подсказок и ответов для режима рекордов.

## v11.8 (Security Update)

### Безопасность

- **SQL Constraints**: Добавлены ограничения на уровне БД (email check, min length).
- **Input Validation**: Введена строгая валидация на клиенте (Regex для логина/ника).
- **XSS Protection**: Методы отображения (`innerHTML`) заменены на безопасные (`textContent`) для пользовательских данных.

## v11.5

### UI/UX

- Исправлена навигация в модальных окнах (кнопки "Назад").
- Обновлен дизайн кнопок в профиле.

## v11.2

### Рефакторинг

- Очистка кода от старых комментариев версионности.
- Перенос истории изменений в `CHANGELOG.md`.

## v11.1

### UI

- Обновлена таблица лидеров:
  - Заголовок изменен на "Таблица лидеров".
  - Добавлена кнопка обновления (Refresh).
  - Убран текст "Loading...".

## v11.0

### Features

- **История игр**: Добавлена возможность просмотра последних 10 игр.
- **Профиль**: Отображение ника вместо логина.

## v10.4

### Fixes

- Исправлен баг "Zombie-account" (ошибка при отсутствии профиля).
- Исправлен креш карты (NaN LatLng).
- Исправлена регистрация (конфликт login/nickname).
